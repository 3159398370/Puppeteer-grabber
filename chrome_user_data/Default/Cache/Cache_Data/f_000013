(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["admin-group"],{"06ca":function(e,t,a){},"0b78":function(e,t,a){"use strict";a("06ca")},"22dc":function(e,t,a){"use strict";a.d(t,"k",(function(){return r})),a.d(t,"o",(function(){return o})),a.d(t,"a",(function(){return n})),a.d(t,"j",(function(){return l})),a.d(t,"m",(function(){return i})),a.d(t,"c",(function(){return c})),a.d(t,"s",(function(){return m})),a.d(t,"g",(function(){return p})),a.d(t,"p",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"t",(function(){return h})),a.d(t,"h",(function(){return f})),a.d(t,"n",(function(){return _})),a.d(t,"e",(function(){return b})),a.d(t,"i",(function(){return v})),a.d(t,"f",(function(){return g})),a.d(t,"r",(function(){return y})),a.d(t,"l",(function(){return k})),a.d(t,"u",(function(){return $})),a.d(t,"q",(function(){return M})),a.d(t,"b",(function(){return x}));var s=a("dde5");const r=e=>Object(s["c"])("api/admin","listCompanies",e),o=e=>Object(s["c"])("api/role","listRoleUsers",e),n=e=>Object(s["c"])("api/role","addRoleUser",e),l=e=>Object(s["c"])("api/role","deleteRoleUser",e),i=e=>Object(s["c"])("api/admin","listPerms",e),c=e=>Object(s["c"])("api/admin","createPerm",e),m=e=>Object(s["c"])("api/admin","updatePerm",e),p=e=>Object(s["c"])("api/admin","deletePerm",e),u=e=>Object(s["c"])("api/role","listRoles",e),d=e=>Object(s["c"])("api/admin","createRole",e),h=e=>Object(s["c"])("api/admin","updateRole",e),f=e=>Object(s["c"])("api/admin","deleteRole",e),_=e=>Object(s["c"])("api/admin","listRolePerms",e),b=e=>Object(s["c"])("api/admin","createRolePerm",e),v=e=>Object(s["c"])("api/admin","deleteRolePerm",e),g=e=>Object(s["c"])("api/admin","createTemplate",e),y=e=>Object(s["c"])("api/admin","listTemplates",e),k=e=>Object(s["c"])("api/admin","getTemplateLevel",e),$=e=>Object(s["c"])("api/admin","updateTemplate",e),M=e=>Object(s["c"])("api/secret","listSystemApps",e),x=e=>Object(s["c"])("api/secret","applySecretKey",e)},"22f8":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("tableFilter",{attrs:{btnDirection:"horizontal"},on:{search:function(t){return e.fetchCompanies(e.page.index=1)},reset:function(t){return e.fetchCompanies(e.company_name="",e.page.index=1)}}},[a("Form",{attrs:{inline:"","label-width":90,"label-colon":!0},nativeOn:{submit:function(t){return t.preventDefault(),e.fetchCompanies(e.page.index=1)}}},[a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"公司名称"}},[a("Input",{attrs:{type:"text",placeholder:"输入公司名称的关键字进行搜索"},model:{value:e.company_name,callback:function(t){e.company_name=t},expression:"company_name"}})],1)],1)],1)],1)],1),a("Table",{ref:"companies",attrs:{border:"",columns:e.columns,data:e.companies,loading:e.fetchCompanies.isPending},scopedSlots:e._u([{key:"company_city",fn:function(t){var s=t.row;return[a("span",[e._v(e._s(s.company_city||"-"))])]}},{key:"company_created_at",fn:function(t){var s=t.row;return[a("span",[e._v(e._s(s.company_created_at||"-"))])]}},{key:"action",fn:function(t){var s=t.row;return[a("a",{on:{click:function(t){return e.showModal("companyDetail",s)}}},[e._v("查看公司详情")])]}}])}),a("Page",{staticClass:"right mtm",attrs:{current:e.page.index,total:e.page.total,"page-size":e.page.size,"show-total":"","show-elevator":""},on:{"on-change":e.changePage}}),a("company-detail",{attrs:{visible:e.companyDetailModal,company:e.companyDetailModel},on:{hideModal:function(t){return e.hideModal("companyDetail")}}})],1)},r=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{attrs:{title:"查看公司详情",width:"800"},on:{"on-cancel":function(t){return e.hideModal()}},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[e.company?a("div",[a("Row",[a("Col",{staticClass:"label",attrs:{span:"5"}},[e._v("公司名称")]),a("Col",{attrs:{span:"19"}},[e._v(e._s(e.company.company_name||"-"))])],1),a("Row",[a("Col",{staticClass:"label",attrs:{span:"5"}},[e._v("公司所在地")]),a("Col",{attrs:{span:"19"}},[e._v(e._s(e.company.company_city||"-"))])],1),a("Row",[a("Col",{staticClass:"label",attrs:{span:"5"}},[e._v("公司成立时间")]),a("Col",{attrs:{span:"19"}},[a("span",[e._v(e._s(e.company.company_created_at||"-"))])])],1),a("Row",[a("Col",{staticClass:"label",attrs:{span:"5"}},[e._v("团队数量")]),a("Col",{attrs:{span:"19"}},[e._v(e._s(e.company.team_count||"-"))])],1),a("Row",[a("Col",{staticClass:"label",attrs:{span:"5"}},[e._v("公司简介")]),a("Col",{attrs:{span:"19"}},[e._v(e._s(e.company.company_desc||"-"))])],1),1===e.company.company_status?[a("br"),a("Row",[a("Col",{staticClass:"label",attrs:{span:"5"}},[e._v("公司状态")]),a("Col",{staticStyle:{color:"#ff9900"},attrs:{span:"19"}},[e._v("申请中")])],1),a("Row",[a("Col",{staticClass:"label",attrs:{span:"5"}},[e._v("申请人")]),a("Col",{attrs:{span:"19"}},[e._v(e._s(e.company.user_entity.nick_name||"-"))])],1),a("Row",[a("Col",{staticClass:"label",attrs:{span:"5"}},[e._v("申请人邮箱")]),a("Col",{attrs:{span:"19"}},[e._v(e._s(e.company.user_entity.email||"-"))])],1),a("Row",[a("Col",{staticClass:"label",attrs:{span:"5"}},[e._v("申请时间")]),a("Col",{attrs:{span:"19"}},[a("span",[e._v(e._s(e.company.created_at||"-"))])])],1)]:e._e(),2===e.company.company_status?[e.company.user_entity?[a("br"),a("Row",[a("Col",{staticClass:"label",attrs:{span:"5"}},[e._v("创建人")]),a("Col",{attrs:{span:"19"}},[e._v(e._s(e.company.user_entity.nick_name||"-"))])],1),a("Row",[a("Col",{staticClass:"label",attrs:{span:"5"}},[e._v("创建人邮箱")]),a("Col",{attrs:{span:"19"}},[e._v(e._s(e.company.user_entity.email||"-"))])],1)]:e._e(),a("Divider"),a("div",{staticClass:"label mbm"},[e._v("公司成员列表")]),a("Form",{nativeOn:{submit:function(t){return t.preventDefault(),e.fetchRoleUsers(e.page.index=1)}}},[a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",[a("Input",{attrs:{type:"text",placeholder:"输入成员昵称关键词"},model:{value:e.form.nick_name,callback:function(t){e.$set(e.form,"nick_name",t)},expression:"form.nick_name"}})],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",[a("Button",{staticClass:"mlm",attrs:{type:"primary"},on:{click:function(t){return e.fetchRoleUsers(e.page.index=1)}}},[e._v("筛选")]),a("Button",{staticClass:"mlm",on:{click:function(t){return e.reset(e.page.index=1)}}},[e._v("重置")])],1)],1)],1)],1),a("Table",{attrs:{columns:e.columns,data:e.roleUsers,loading:e.fetchRoleUsers.isPending}}),a("Row",{staticClass:"mtm mbm",attrs:{type:"flex",justify:"space-between"}},[a("div"),a("Page",{attrs:{current:e.page.index,total:e.page.total,"page-size":e.page.size,"show-total":"","show-elevator":""},on:{"on-change":e.changePage}})],1)]:e._e()],2):e._e(),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("span")])])},n=[],l=a("9ec3"),i=a("e3fa"),c={props:{visible:Boolean,company:Object},data(){return{modal:this.visible,form:{nick_name:""},columns:[{title:"成员名称",key:"nick_name",width:180},{title:"邮箱",key:"email",width:200},{title:"成员角色",key:"role_name"}],roleUsers:[],page:{index:1,size:10,total:0}}},watch:{visible(){this.modal=this.visible,this.visible&&this.fetchRoleUsers()}},methods:{reset(){Object(l["forIn"])(this.form,(e,t)=>{this.form[t]=""}),this.fetchRoleUsers()},changePage(e){this.page.index=e,this.fetchRoleUsers()},hideModal(e){this.$emit("hideModal",e)}},asyncMethods:{fetchRoleUsers(){const e={page:{start:(this.page.index-1)*this.page.size,size:this.page.size,return_total:1},object_id:this.company.company_id,object_type:"company",user_type:"user"};return Object(l["forIn"])(this.form,(t,a)=>{t&&(e[a]=this.form[a])}),Object(i["q"])(e).then(e=>(this.page.total=e.total,e.data)).catch(e=>{console.log(e),this.$Message.error("列表数据获取失败，请刷新重试")})}}},m=c,p=(a("b4a9"),a("2be6")),u=Object(p["a"])(m,o,n,!1,null,"ee95d82c",null),d=u.exports,h=a("8859"),f=a("22dc"),_=a("c605"),b={components:{CompanyDetail:d,tableFilter:_["a"]},mixins:[h["a"]],modals:["companyDetail"],data(){return{columns:[{title:"公司ID",key:"company_id"},{title:"公司名称",key:"company_name"},{title:"公司所在地",slot:"company_city"},{title:"公司成立时间",slot:"company_created_at"},{title:"操作",slot:"action"}],companies:[],page:{index:1,size:10,total:0},company_name:""}},mounted(){this.fetchCompanies()},methods:{changePage(e){this.page.index=e,this.fetchCompanies()}},asyncMethods:{fetchCompanies(){const e={page:{start:(this.page.index-1)*this.page.size,size:this.page.size},return_total:1,company_status:2};return this.company_name&&(e.company_name=this.company_name),f["k"](e).then(e=>(this.page.total=e.total,e.data)).catch(e=>{console.log(e),this.$Message.error("列表数据获取失败，请刷新重试")})}}},v=b,g=(a("d9a8"),Object(p["a"])(v,s,r,!1,null,"7cacc7d5",null));t["default"]=g.exports},2309:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"mtm"},[a("TableFilter",{attrs:{btnDirection:"horizontal"},on:{search:function(t){return e.fetchTemplates(e.page.index=1)},reset:function(t){return e.Reset(e.page.index=1)}}},[a("Form",{attrs:{model:e.form,inline:"","label-width":90,"label-colon":!0}},[a("Row",{attrs:{gutter:20}},[a("Col",{attrs:{span:"7"}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"标注场景",prop:"template_scene"}},[a("Select",{staticStyle:{width:"100%"},attrs:{clearable:"",filterable:""},on:{"on-clear":function(t){e.form.template_scene="",e.form.template_level=""}},model:{value:e.form.template_scene,callback:function(t){e.$set(e.form,"template_scene",t)},expression:"form.template_scene"}},e._l(e.TemplateScenes,(function(t){return a("Option",{key:t,staticClass:"mrl",attrs:{value:t}},[e._v(e._s(t))])})),1)],1)],1),a("Col",{attrs:{span:"7"}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"模板类型",prop:"template_level1"}},[a("Select",{staticStyle:{width:"100%"},attrs:{clearable:"",filterable:""},on:{"on-clear":function(t){e.form.template_level=""}},model:{value:e.form.template_level,callback:function(t){e.$set(e.form,"template_level",t)},expression:"form.template_level"}},e._l(e.templateLevels,(function(e){return a("Option",{key:e.template_id,attrs:{value:e.template_id,label:e.template_level1+(e.template_level2?" / "+e.template_level2:"")}})})),1)],1)],1),a("Col",{attrs:{span:"7"}},[a("FormItem",{staticStyle:{width:"100%"},attrs:{label:"最后修改人",prop:"updated_by"}},[a("Input",{attrs:{type:"text",placeholder:"请输入最后修改人"},model:{value:e.form.updated_by,callback:function(t){e.$set(e.form,"updated_by",t)},expression:"form.updated_by"}})],1)],1)],1)],1)],1)],1),a("Button",{staticClass:"mbb",attrs:{type:"primary",icon:"md-add",to:"/admin/template/create"}},[e._v("新增模板")]),a("Table",{ref:"templates",attrs:{border:"",columns:e.columns,data:e.templates,loading:e.fetchTemplates.isPending},scopedSlots:e._u([{key:"template_level",fn:function(t){var s=t.row;return[a("span",[e._v(e._s(s.template_level1))]),s.template_level2?a("span",[e._v(e._s(" / "+s.template_level2))]):e._e()]}},{key:"action",fn:function(t){var s=t.row;return[a("router-link",{attrs:{to:{path:"/templates/"+s.id+"/preview",params:{id:s.id}},target:"_blank"}},[e._v("预览")]),a("Divider",{attrs:{type:"vertical"}}),a("router-link",{attrs:{to:{name:"template-edit",params:{id:s.id},query:{from:"template"}},target:"_blank"}},[e._v("编辑")]),a("Divider",{attrs:{type:"vertical"}}),a("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.remove(s)}}},[e._v("删除")]),a("Divider",{attrs:{type:"vertical"}}),0===s.is_public?[a("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.fetchUpdateTemplatePublic(s)}}},[e._v("发布")])]:[a("span",{staticClass:"txt-muted"},[e._v("已发布")])]]}}])}),a("Page",{staticClass:"right mtm",attrs:{current:e.page.index,total:e.page.total,"page-size":e.page.size,"show-total":"","show-elevator":""},on:{"on-change":e.changePage}})],1)},r=[],o=a("9ec3"),n=a.n(o),l=a("8859"),i=a("22dc"),c=a("b0f9"),m=a("2289"),p=a("bccd"),u=a.n(p),d=a("c605"),h={components:{TableFilter:d["a"]},mixins:[l["a"]],data(){return{TemplateScenes:m["i"],columns:[{title:"模板ID",key:"id",width:100,align:"center"},{title:"模板名称",key:"template_name"},{title:"模板描述",key:"template_desc"},{title:"标注场景",key:"template_scene",align:"center"},{title:"模板类型",slot:"template_level"},{title:"最后修改时间",key:"updated_at"},{title:"最后修改人",key:"editor"},{title:"操作",slot:"action",minWidth:180}],templates:[],page:{index:1,size:10,total:0},form:{template_scene:"",template_level:"",updated_by:""},templateLevels:[]}},watch:{"form.template_scene"(){this.form.template_scene?this.fetchTemplateLevels():this.templateLevels=[]}},mounted(){this.fetchTemplates()},methods:{Reset(){n.a.forIn(this.form,(e,t)=>{this.form[t]=""}),this.fetchTemplates()},changePage(e){this.page.index=e,this.fetchTemplates()},remove(e){this.$Modal.confirm({title:"确定要删除这个通用模板吗？",content:`【${e.template_name}】`,onOk:()=>{this.fetchDeleteTemplate(e)}})}},asyncMethods:{fetchTemplates(){const e={page:{start:(this.page.index-1)*this.page.size,size:this.page.size},return_total:1};if(""!==this.form.template_scene&&(e.template_scene=this.form.template_scene),this.form.template_scene&&this.form.template_level){const t=n.a.find(this.templateLevels,["template_id",this.form.template_level]);t.template_level1&&(e.template_level1=t.template_level1),t.template_level2&&(e.template_level2=t.template_level2)}return""!==this.form.updated_by&&(e.updated_by=this.form.updated_by),i["r"](e).then(e=>(this.page.total=e.total,e.data)).catch(e=>{console.log(e),this.$Message.error("列表数据获取失败，请刷新重试")})},fetchUpdateTemplatePublic(e){const t={template_id:e.id,is_public:1};return Object(c["h"])(t).then(e=>{e&&this.$Message.success("发布成功！"),this.fetchTemplates()})},fetchDeleteTemplate(e){const t={template_id:u()(e.id)};return Object(c["d"])(t).then(e=>{console.log(e),e&&(this.$Message.success("删除成功！"),this.fetchTemplates())}).catch(e=>{this.$Message.error("删除失败："+e.message)})},fetchTemplateLevels(){const e={template_scene:this.form.template_scene,is_all:1};return i["l"](e).then(e=>e)}}},f=h,_=(a("7c6d"),a("2be6")),b=Object(_["a"])(f,s,r,!1,null,"54b781be",null);t["default"]=b.exports},"261f":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{attrs:{width:"700","mask-closable":!1,scrollable:!0},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[a("h3",{staticClass:"mts mbs"},[e._v("将"+e._s(e.objectTypeOptions[e.objectType])+"分享给……")])]),a("div",{staticClass:"content"},[a("Form",{ref:"form",attrs:{"label-width":0}},[a("Row",{attrs:{gutter:10}},[a("Col",{attrs:{span:"3"}},[a("FormItem",[a("Select",{model:{value:e.userType,callback:function(t){e.userType=t},expression:"userType"}},[e._l(e.userTypeOptions,(function(t,s){return[!e.userTypeFilter||e.userTypeFilter.includes(s)?a("Option",{key:s,attrs:{value:s}},[e._v(e._s(t.label))]):e._e()]}))],2)],1)],1),"user"===e.userType?a("Col",{attrs:{span:"17"}},["application"!==e.objectType?a("FormItem",{attrs:{prop:"user"}},[a("Select",{attrs:{"label-in-value":"","remote-method":e.debounce,loading:e.loading,filterable:"",multiple:"",transfer:"",placeholder:"请输入用户名称或邮箱关键字，以搜索相关用户"},on:{"on-change":function(t){e.usersMap=t}},model:{value:e.users,callback:function(t){e.users=t},expression:"users"}},e._l(e.userOptions,(function(t){return a("Option",{key:t.user_id,attrs:{value:t.user_id,label:t.nick_name+t.email,tag:t.nick_name}},[a("p",[e._v(e._s(t.nick_name))]),a("p",{staticClass:"txt-muted"},[e._v(e._s(t.email||"无邮箱"))])])})),1)],1):a("FormItem",{attrs:{prop:"user"}},[a("auth-view",{attrs:{perm:{domain:"system",action:"manage",extra:{}}}},[a("Select",{attrs:{slot:"forbidden",transfer:"",placeholder:"请输入用户名称或邮箱关键字，以搜索相关用户"},slot:"forbidden"}),a("Select",{attrs:{"label-in-value":"","remote-method":e.debounce,loading:e.loading,filterable:"",multiple:"",transfer:"",placeholder:"请输入用户名称，以搜索相关用户"},on:{"on-change":function(t){e.usersMap=t}},model:{value:e.users,callback:function(t){e.users=t},expression:"users"}},e._l(e.adminUserOptions,(function(t){return a("Option",{key:t.user_id,attrs:{value:t.user_id,label:t.nick_name+t.email,tag:t.nick_name}},[a("p",[e._v(e._s(t.nick_name))]),a("p",{staticClass:"txt-muted"},[e._v(e._s(t.email||"无邮箱"))])])})),1)],1)],1)],1):e._e(),"app"===e.userType?a("Col",{attrs:{span:"17"}},[a("FormItem",{attrs:{prop:"app"}},[a("Select",{attrs:{"label-in-value":"","remote-method":e.debounce,loading:e.loading,filterable:"",multiple:"",transfer:"",placeholder:"请输入应用ID或应用名称，以搜索相关应用"},on:{"on-change":function(t){e.usersMap=t}},model:{value:e.users,callback:function(t){e.users=t},expression:"users"}},e._l(e.appOptions,(function(t,s){return a("Option",{key:s,attrs:{value:t.app_id.toString(),label:t.app_name+t.app_id,tag:t.app_name}},[a("p",[e._v(e._s(t.app_name))]),a("p",{staticClass:"txt-muted"},[e._v(e._s(t.app_id))])])})),1)],1)],1):e._e(),a("Col",{attrs:{span:"4"}},[a("Button",{attrs:{type:"primary",loading:e.loading},on:{click:e.submit}},[e._v("添加")])],1)],1)],1),a("Table",{staticStyle:{"min-height":"350px"},attrs:{loading:e.fetchShareList.isPending,columns:e.columns,data:e.shareList},scopedSlots:e._u([{key:"action",fn:function(t){var s=t.row;return[a("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.fetchDeleteRoleUser(s)}}},[e._v("删除")])]}}])}),a("Page",{staticClass:"right mtm",attrs:{current:e.page.index,total:e.page.total,"page-size":e.page.size,"show-total":"","show-elevator":""},on:{"on-change":e.changePage}})],1),a("div",{staticClass:"footer",attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:function(t){e.visible=!1}}},[e._v("关闭")])],1)])},r=[],o=(a("8d0d"),a("9ec3")),n=a("22dc"),l=a("e3fa"),i={props:{objectId:[Object,String,Number],objectType:String,userTypeFilter:[String,Array],companyinfo:Object},data(){return{visible:!0,userOptions:[],userType:"",users:[],usersMap:[],userTypeOptions:{user:{value:0,label:"用户"},app:{value:2,label:"应用"}},objectTypeOptions:{project:"项目",template:"模板",dataset:"数据集",tagset:"标签集",application:"应用"},columnsOptions:{user:{nick_name:"用户名称",role_name:"权限",action:"操作"},app:{app_name:"应用名称",role_name:"权限",action:"操作"}},shareList:[],page:{index:1,size:5,total:0}}},computed:{columns(){const{userType:e,columnsOptions:t}=this;return Object(o["map"])(t[e],(e,t)=>{const a={title:e,key:t};return t.includes("action")&&(delete a.key,this.$set(a,"slot",t)),a})},loading(){return this.fetchShareList.isPending||this.fetchUserOptions.isPending||this.fetchAppOptions.isPending||this.fetchAdminUserOptions.isPending||this.fetchShareObject.isPending||this.fetchDeleteRoleUser.isPending},queryParams(){return function(e){const t={page:{start:0,size:100,return_total:0},query:e};return t}},submitParams(){const{objectId:e,userType:t,users:a}=this,s={object_id:e,user_list:a,user_type:t};return s}},watch:{userType(){this.reset()}},mounted(){this.userType="user"},methods:{reset(){this.users=[],this.fetchShareList()},debounce:Object(o["debounce"])((function(e){"application"===this.objectType?this.fetchAdminUserOptions(e):("user"===this.userType&&this.fetchUserOptions(e),"app"===this.userType&&this.fetchAppOptions(e))}),500),async submit(){const{label:e}=this.userTypeOptions[this.userType];if(this.users.length<=0)this.$Message.error("添加失败，请先选择"+e);else{const t=await this.fetchRole(this.objectType);if(t){const a=[];for(let r=0;r<this.users.length;r++){const s=this.users[r],n=await this.fetchShareObject(s,t.role_id);if(n&&a.push(n),!0!==n){const t=Object(o["find"])(this.usersMap,e=>e.value===s).tag||"";this.$Message.error(`分享失败：${e}${t}：${n.message}`)}}const s=Object(o["countBy"])(a,e=>!0===e).true;s===this.users.length&&this.$Message.success(`成功分享给${s}个${e}`),this.reset()}}},changePage(e){this.page.index=e,this.reset()}},asyncMethods:{fetchShareList(){const{objectId:e,objectType:t,userType:a,page:s}=this,r={object_id:e,object_type:t,user_type:a,page:{start:(s.index-1)*s.size,size:s.size,return_total:1}};return Object(l["r"])(r).then(e=>(s.total=e.total,e.data||[])).catch(e=>{console.log(e),this.$Message.error("列表数据获取失败，请刷新页面重试")})},fetchUserOptions(e){if(""!==e)return Object(l["t"])(this.queryParams(e)).then(e=>e.data)},fetchAppOptions(e){if(""!==e)return Object(l["l"])(this.queryParams(e)).then(e=>(this.appOptions=e.data,this.appOptions))},fetchAdminUserOptions(e){if(""!==e)return Object(l["t"])(this.queryParams(e)).then(e=>e.data)},fetchRole(e){const t={object_id:this.objectId,object_type:e,role_type:"owner"};return Object(l["j"])(t)},fetchShareObject(e,t){const{objectId:a,userType:s}=this,r={user_id_list:[e],object_id:a,role_id:t,user_type:s};return Object(l["a"])(r).then(e=>e).catch(e=>e)},fetchDeleteRoleUser(e){const t={user_role_id:e.user_role_id};return Object(n["j"])(t).then(e=>{e?(this.$Message.success("删除成功！"),this.reset()):this.$Message.error("删除失败")}).catch(e=>{this.$Message.error("删除失败："+e.message)})}}},c=i,m=(a("f607"),a("2be6")),p=Object(m["a"])(c,s,r,!1,null,"efae4070",null);t["a"]=p.exports},"2a20":function(e,t,a){"use strict";var s=a("fb60"),r=a("40bb"),o=(a("5030"),a("2be6")),n=Object(o["a"])(r["default"],s["a"],s["b"],!1,null,"40cfb280",null);t["default"]=n.exports},"2b0e":function(e,t,a){},"2e20":function(e,t,a){},"322b":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("div",{staticClass:"mbm"},[a("Button",{staticClass:"mrm",attrs:{type:"primary",icon:"md-add"},on:{click:function(t){return e.showModal("roleCreate")}}},[e._v("新增角色")])],1),a("Table",{ref:"companies",attrs:{border:"",columns:e.columns,data:e.roles,loading:e.fetchRoles.isPending},on:{"on-expand":e.showRolePerm},scopedSlots:e._u([{key:"action",fn:function(t){var s=t.row;return[a("a",{on:{click:function(t){return e.showModal("roleEdit",s)}}},[e._v("编辑")]),a("Divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.showModal("rolePerm",s)}}},[e._v("权限配置")]),a("Divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.Delete(s)}}},[e._v("删除角色")])]}}])}),a("Page",{staticClass:"right mtm",attrs:{current:e.page.index,total:e.page.total,"page-size":e.page.size,"show-total":"","show-elevator":""},on:{"on-change":e.changePage}})],1),a("role-create",{attrs:{visible:e.roleCreateModal},on:{hideModal:function(t){e.hideModal("roleCreate","refresh"===t?e.fetchRoles():"")}}}),a("role-edit",{attrs:{visible:e.roleEditModal,model:e.roleEditModel},on:{hideModal:function(t){e.hideModal("roleEdit","refresh"===t?e.fetchRoles():"")}}}),a("role-perm",{attrs:{visible:e.rolePermModal,model:e.rolePermModel},on:{hideModal:function(t){e.hideModal("rolePerm","refresh"===t?e.fetchRoles():"")}}})],1)},r=[],o=a("9ec3"),n=a.n(o),l=a("8859"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{attrs:{width:"600",title:"新增角色","mask-closable":!1},on:{"on-cancel":function(t){return e.hideModal()}},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[e.visible?[a("Form",{ref:"createForm",attrs:{model:e.form}},[a("FormItem",{attrs:{label:"角色名称",prop:"role_name",rules:{required:!0,message:"不能为空"}}},[a("Input",{attrs:{placeholder:"请填写角色名称"},model:{value:e.form.role_name,callback:function(t){e.$set(e.form,"role_name",t)},expression:"form.role_name"}})],1),a("FormItem",{attrs:{label:"角色描述",prop:"memo",rules:{required:!0,message:"不能为空"}}},[a("Input",{attrs:{placeholder:"请填写角色描述"},model:{value:e.form.memo,callback:function(t){e.$set(e.form,"memo",t)},expression:"form.memo"}})],1),a("FormItem",{attrs:{label:"object_type",prop:"object_type",rules:{required:!0,message:"不能为空"}}},[a("Select",{attrs:{placeholder:"请选择object_type",filterable:"","allow-create":""},on:{"on-create":e.handleCreatePerm},model:{value:e.form.object_type,callback:function(t){e.$set(e.form,"object_type",t)},expression:"form.object_type"}},e._l(e.perms,(function(t){return a("Option",{key:t.domain,attrs:{value:t.domain}},[e._v(e._s(t.domain))])})),1)],1),a("FormItem",{attrs:{label:"role_type",prop:"role_type",rules:{required:!0,message:"不能为空"}}},[a("Input",{attrs:{placeholder:"请填写role_type"},model:{value:e.form.role_type,callback:function(t){e.$set(e.form,"role_type",t)},expression:"form.role_type"}})],1)],1)]:e._e(),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:e.hideModal}},[e._v("取消")]),a("Button",{attrs:{type:"primary",loading:e.fetchCreateRole.isPending},on:{click:e.Submit}},[e._v("确定")])],1)],2)},c=[],m=a("22dc"),p={props:{visible:Boolean},data(){return{modal:this.visible,perms:[],form:{role_name:"",memo:"",object_type:"",role_type:""}}},watch:{visible(){this.modal=this.visible,this.visible&&this.fetchPerms()}},methods:{hideModal(e){this.$emit("hideModal",e),this.$refs.createForm.resetFields(),this.form={role_name:"",memo:"",object_type:"",role_type:""}},Submit(){this.$refs.createForm.validate(e=>{e?this.fetchCreateRole():this.$Message.error("提交失败，请检查是否有遗漏")})},TreePerms(e){const t=[];return n.a.map(e,e=>{if(t.length<=0)t.push({domain:e.domain,children:[e]});else{const a=n.a.findIndex(t,t=>t.domain===e.domain);-1===a?t.push({domain:e.domain,children:[e]}):t[a].children.push(e)}}),t},handleCreatePerm(e){this.perms.push({domain:e,children:[]})}},asyncMethods:{fetchCreateRole(){const e={role_name:this.form.role_name,memo:this.form.memo,object_type:this.form.object_type,role_type:this.form.role_type};return m["d"](e).then(e=>{e?(this.$Message.success("提交成功"),this.hideModal("refresh")):this.$Message.error("提交失败："+e.message)}).catch(e=>{console.log(e),this.$Message.error("提交失败："+e.message)})},fetchPerms(){const e={};return this.domain&&(e.domain=this.domain),this.action&&(e.action=this.action),m["m"](e).then(e=>{n.a.remove(e,e=>"*"===e.domain);const t=this.TreePerms(e);return t.length<=this.activeIndex&&(this.activeIndex=""),console.log(t),t})}}},u=p,d=a("2be6"),h=Object(d["a"])(u,i,c,!1,null,null,null),f=h.exports,_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{attrs:{width:"600",title:"编辑角色","mask-closable":!1},on:{"on-cancel":function(t){return e.hideModal()}},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[e.visible?[a("Form",{ref:"editForm",attrs:{model:e.form}},[a("FormItem",{attrs:{label:"角色名称",prop:"role_name",rules:{required:!0,message:"不能为空"}}},[a("Input",{attrs:{placeholder:"请填写角色名称"},model:{value:e.form.role_name,callback:function(t){e.$set(e.form,"role_name",t)},expression:"form.role_name"}})],1),a("FormItem",{attrs:{label:"角色描述",prop:"memo",rules:{required:!0,message:"不能为空"}}},[a("Input",{attrs:{placeholder:"请填写角色描述"},model:{value:e.form.memo,callback:function(t){e.$set(e.form,"memo",t)},expression:"form.memo"}})],1),a("FormItem",{attrs:{label:"object_type",prop:"object_type",rules:{required:!0,message:"不能为空"}}},[a("Select",{attrs:{placeholder:"请选择object_type"},model:{value:e.form.object_type,callback:function(t){e.$set(e.form,"object_type",t)},expression:"form.object_type"}},e._l(e.perms,(function(t){return a("Option",{key:t.domain,attrs:{value:t.domain}},[e._v(e._s(t.domain))])})),1)],1),a("FormItem",{attrs:{label:"role_type",prop:"role_type",rules:{required:!0,message:"不能为空"}}},[a("Input",{attrs:{placeholder:"请填写role_type"},model:{value:e.form.role_type,callback:function(t){e.$set(e.form,"role_type",t)},expression:"form.role_type"}})],1)],1)]:e._e(),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:e.hideModal}},[e._v("取消")]),a("Button",{attrs:{type:"primary",loading:e.fetchUpdateRole.isPending},on:{click:e.Submit}},[e._v("确定")])],1)],2)},b=[],v={props:{visible:Boolean,model:Object},data(){return{modal:this.visible,perms:[],form:{role_name:"",memo:"",object_type:"",role_type:""}}},watch:{visible(){this.modal=this.visible,this.visible&&(this.fetchPerms(),this.form.role_name=this.model.role_name,this.form.memo=this.model.memo,this.form.object_type=this.model.object_type,this.form.role_type=this.model.role_type)}},methods:{hideModal(e){this.$emit("hideModal",e),this.$refs.editForm.resetFields(),this.form={role_name:"",memo:"",object_type:"",role_type:""}},Submit(){this.$refs.editForm.validate(e=>{e?this.fetchUpdateRole():this.$Message.error("提交失败，请检查是否有遗漏")})},TreePerms(e){const t=[];return n.a.map(e,e=>{if(t.length<=0)t.push({domain:e.domain,children:[e]});else{const a=n.a.findIndex(t,t=>t.domain===e.domain);-1===a?t.push({domain:e.domain,children:[e]}):t[a].children.push(e)}}),t}},asyncMethods:{fetchUpdateRole(){const e={role_id:this.model.role_id,role_name:this.form.role_name,memo:this.form.memo,object_type:this.form.object_type,role_type:this.form.role_type};return m["t"](e).then(e=>{e?(this.$Message.success("提交成功"),this.hideModal("refresh")):this.$Message.error("提交失败："+e.message)}).catch(e=>{console.log(e),this.$Message.error("提交失败："+e.message)})},fetchPerms(){const e={};return this.domain&&(e.domain=this.domain),this.action&&(e.action=this.action),m["m"](e).then(e=>{n.a.remove(e,e=>"*"===e.domain);const t=this.TreePerms(e);return t.length<=this.activeIndex&&(this.activeIndex=""),console.log(t),t})}}},g=v,y=Object(d["a"])(g,_,b,!1,null,null,null),k=y.exports,$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{attrs:{width:"800",title:"角色权限配置","mask-closable":!1},on:{"on-cancel":function(t){return e.hideModal()}},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[e.visible&&e.model?[a("Form",{ref:"permForm",attrs:{model:e.form}},[a("Row",{attrs:{gutter:8,align:"bottom"}},[a("Col",{attrs:{span:"10"}},[a("FormItem",{attrs:{label:"选择权限",prop:"perm_id",rules:{required:!0,message:"不能为空"}}},[a("Select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:"请选择要给角色添加的权限"},model:{value:e.form.perm_id,callback:function(t){e.$set(e.form,"perm_id",t)},expression:"form.perm_id"}},e._l(e.perms,(function(t){return a("Option",{key:t.perm_id,attrs:{value:t.perm_id}},[e._v(e._s(t.perm_name)+" ( "+e._s(t.domain)+":"+e._s(t.action)+" )")])})),1)],1)],1),a("Col",{attrs:{span:"10"}},[a("FormItem",{attrs:{label:"填写参数"}},[a("Input",{attrs:{placeholder:'非必填，例如{"params1":"x","params2":"y"}'},model:{value:e.form.perm_params,callback:function(t){e.$set(e.form,"perm_params",t)},expression:"form.perm_params"}})],1)],1),a("Col",{attrs:{span:"4"}},[a("FormItem",{attrs:{label:""}},[a("Button",{attrs:{type:"primary",loading:e.fetchCreateRolePerm.isPending},on:{click:e.Submit}},[e._v("确认添加")])],1)],1)],1)],1),a("br"),a("Divider",{attrs:{orientation:"left"}},[e._v(e._s(e.model.role_name)+"已拥有的权限")]),a("Table",{attrs:{columns:e.columns,data:e.rolePerms,loading:e.fetchRolePerms.isPending,height:"500"},scopedSlots:e._u([{key:"action",fn:function(t){var s=t.row;return[a("a",{on:{click:function(t){return e.Delete(s)}}},[e._v("移除")])]}}],null,!1,1214129820)})]:e._e(),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("span")])],2)},M=[],x={props:{visible:Boolean,model:Object},data(){return{modal:this.visible,columns:[{title:"角色权限",key:"perm_name"},{title:"domain",key:"domain"},{title:"action",key:"action"},{title:"参数",key:"perm_params",minWidth:120},{title:"操作",slot:"action"}],rolePerms:[],perms:[],form:{perm_id:"",perm_params:""}}},watch:{visible(){this.modal=this.visible,this.visible&&(this.fetchRolePerms(),this.fetchPerms())}},methods:{reset(){this.$refs.permForm.resetFields(),this.form={perm_id:"",perm_params:""},this.rolePerms=[]},hideModal(e){this.$emit("hideModal",e),this.reset()},Submit(){this.$refs.permForm.validate(e=>{e?this.fetchCreateRolePerm():this.$Message.error("提交失败，请检查是否有遗漏")})},Delete(e){this.$Modal.confirm({title:"移除角色权限",content:`确定移除${this.model.role_name}的【${e.perm_name}】权限吗？`,loading:!0,onOk:()=>{this.fetchDeleteRolePerm(e).then(()=>{this.$Modal.remove()})}})}},asyncMethods:{fetchRolePerms(){const e={role_id:this.model.role_id};return m["n"](e).then(e=>e)},fetchPerms(){const e={};return m["m"](e).then(e=>e).catch(e=>{console.log(e),this.$Message.error("列表数据获取失败，请刷新重试")})},fetchCreateRolePerm(){const e={role_id:this.model.role_id,perm_id:this.form.perm_id,perm_params:this.form.perm_params||"{}"};return m["e"](e).then(e=>{e?(this.$Message.success("提交成功"),this.reset(),this.fetchRolePerms()):this.$Message.error("提交失败："+e.message)}).catch(e=>{console.log(e),this.$Message.error("提交失败："+e.message)})},fetchDeleteRolePerm(e){const t={role_perm_id:e.role_perm_id};return m["i"](t).then(e=>{e?(this.$Message.success("提交成功"),this.fetchRolePerms()):this.$Message.error("提交失败："+e.message)}).catch(e=>{console.log(e),this.$Message.error("提交失败："+e.message)})}}},j=x,O=Object(d["a"])(j,$,M,!1,null,null,null),w=O.exports,C={components:{RoleCreate:f,RoleEdit:k,RolePerm:w},mixins:[l["a"]],modals:["roleCreate","roleEdit","rolePerm"],data(){return{columns:[{title:"角色ID",key:"role_id",width:100},{title:"角色名称",key:"role_name"},{title:"角色描述",key:"memo"},{title:"操作",slot:"action"}],roles:[],rolePerms:[],page:{index:1,size:10,total:0}}},mounted(){this.fetchRoles()},methods:{Delete(e){this.$Modal.confirm({title:"删除角色",content:`确定要删除【${e.role_name}】这个角色吗？`,loading:!0,onOk:()=>{this.fetchDeleteRole(e).then(()=>{this.$Modal.remove()})}})},showRolePerm(e,t){t&&(n.a.has(e,"perms")||this.fetchRolePerms(e.role_id),console.log(e))},changePage(e){this.page.index=e,this.fetchRoles()}},asyncMethods:{fetchRoles(){const e={page:{start:(this.page.index-1)*this.page.size,size:this.page.size,return_total:1}};return m["p"](e).then(e=>(this.page.total=e.total,e.data)).catch(e=>{console.log(e),this.$Message.error("列表数据获取失败，请刷新重试")})},fetchDeleteRole(e){const t={role_id:e.role_id};return m["h"](t).then(e=>{e?(this.$Message.success("删除角色成功！"),this.fetchRoles()):this.$Message.error("删除角色失败")}).catch(e=>{this.$Message.error("删除角色失败："+e.message)})}}},P=C,I=(a("b0e4"),Object(d["a"])(P,s,r,!1,null,"0d6eb6cf",null));t["default"]=I.exports},"40bb":function(e,t,a){"use strict";var s=a("54f6"),r=a.n(s);t["default"]=r.a},5030:function(e,t,a){"use strict";a("8bdd")},"510c":function(e,t,a){},"54f6":function(e,t){},5897:function(e,t,a){},"611e":function(e,t,a){},"7c6d":function(e,t,a){"use strict";a("2e20")},8859:function(e,t,a){"use strict";var s=a("9ec3"),r=a.n(s);t["a"]={modals:[],data(){const e={};return r.a.forEach(this.$options.modals,t=>{e[t+"Modal"]=!1,e[t+"Model"]=null}),e},methods:{showModal(e,t){this[e+"Modal"]=!0,this[e+"Model"]=t},hideModal(e){this[e+"Modal"]=!1}}}},"8bdd":function(e,t,a){},a764:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",[e._v("123")])},r=[],o={},n=o,l=a("2be6"),i=Object(l["a"])(n,s,r,!1,null,null,null);t["default"]=i.exports},b0e4:function(e,t,a){"use strict";a("b81d")},b484:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"mbm"},[a("Button",{staticClass:"mrm",attrs:{type:"primary",icon:"md-add"},on:{click:e.managerAdd}},[e._v("新增管理员")])],1),a("Table",{ref:"companies",attrs:{border:"",columns:e.columns,data:e.roleUsers,loading:e.fetchRoleUsers.isPending},scopedSlots:e._u([{key:"action",fn:function(t){var s=t.row;return[a("a",{on:{click:function(t){return e.Delete(s)}}},[e._v("删除管理员")])]}}])}),a("Page",{staticClass:"right mtm",attrs:{current:e.page.index,total:e.page.total,"page-size":e.page.size,"show-total":"","show-elevator":""},on:{"on-change":e.changePage}}),a("manager-delete",{ref:"managerDelete"})],1)},r=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{attrs:{width:"600",title:"新增管理员","mask-closable":!1},on:{"on-cancel":function(t){return e.hideModal()}},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("div",{staticStyle:{position:"relative"}},[a("Form",{ref:"form",attrs:{model:e.form,"hide-required-mark":""}},[a("FormItem",{attrs:{label:"选择需要新增为平台管理员的用户",prop:"user",rules:e.ruleNotEmpty}},[a("user-select",{ref:"userSelect",attrs:{remote:"",showEmail:""},on:{"update:user":function(t){e.form.user=t}}})],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:function(t){return e.hideModal()}}},[e._v("取消")]),a("Button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确定")])],1)])},n=[],l=a("22dc"),i=a("bccd"),c=a.n(i),m=a("f227"),p={components:{UserSelect:m["a"]},data(){return{visible:!0,form:{user:""},ruleNotEmpty:{required:!0,message:" "}}},methods:{submit(){this.$refs.form.validate(e=>{if(e)return this.fetchAddRoleUser();this.$Message.error("提交失败，请检查是否有遗漏")})},hideModal(e){this.visible=!1,e&&this.$emit(e)}},asyncMethods:{fetchAddRoleUser(){const e={user_id_list:[c()(this.form.user).toString()],object_id:0,role_id:1,user_type:"user"};return l["a"](e).then(e=>{e?(this.$Message.success("提交成功！"),this.hideModal("refresh")):this.$Message.error("提交失败："+e.message)}).catch(e=>{console.log(e),this.$Message.error("提交失败："+e.message)})}}},u=p,d=a("2be6"),h=Object(d["a"])(u,o,n,!1,null,null,null),f=h.exports,_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div")},b=[],v={props:{object:Object},data(){return{manager:{}}},methods:{DeleteManager(e){const t=new Promise(t=>{this.manager=e,this.$Modal.confirm({title:"删除用户角色",content:"确定要删除这个平台管理员吗？",loading:!0,onOk:()=>{this.fetchDeleteRoleUser(e).then(()=>{t(),this.$Modal.remove()})}})});return t}},asyncMethods:{fetchDeleteRoleUser(e){const t={user_role_id:e.user_role_id};return Object(l["j"])(t).then(e=>{e?this.$Message.success("删除成功！"):this.$Message.error("删除失败")}).catch(e=>{this.$Message.error("删除失败："+e.message)})}}},g=v,y=Object(d["a"])(g,_,b,!1,null,null,null),k=y.exports,$={components:{managerAdd:f,managerDelete:k},data(){return{columns:[{title:"用户ID",key:"user_id"},{title:"管理员名称",key:"nick_name"},{title:"邮箱",key:"email"},{title:"操作",slot:"action"}],roleUsers:[],page:{index:1,size:10,total:0}}},mounted(){this.fetchRoleUsers()},methods:{managerAdd(){const e=this;e.$FastModal.show(f,{},{refresh(){e.fetchRoleUsers()}})},Delete(e){this.$refs.managerDelete.DeleteManager(e).then(()=>{this.fetchRoleUsers()})},changePage(e){this.page.index=e,this.fetchRoleUsers()}},asyncMethods:{fetchRoleUsers(){const e={page:{start:(this.page.index-1)*this.page.size,size:this.page.size,return_total:1},object_id:0,object_type:"system",role_type_list:["admin"],user_type:"user"};return l["o"](e).then(e=>(this.page.total=e.total,e.data)).catch(e=>{console.log(e),this.$Message.error("列表数据获取失败，请刷新重试")})}}},M=$,x=(a("ea81"),Object(d["a"])(M,s,r,!1,null,"5055bdb0",null));t["default"]=x.exports},b4a9:function(e,t,a){"use strict";a("2b0e")},b81d:function(e,t,a){},bcee:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Row",{attrs:{type:"flex",justify:"space-between"}},[a("auth-view",{attrs:{perm:{domain:"system",action:"manage",extra:{}}}},[a("Button",{attrs:{type:"success",icon:"md-add"},on:{click:e.createApp}},[e._v("添加新的应用")])],1),a("Form",{ref:"form",attrs:{inline:"","label-width":0}},[a("FormItem",[a("Input",{attrs:{placeholder:"请输入应用ID"},model:{value:e.form.app_id,callback:function(t){e.$set(e.form,"app_id",t)},expression:"form.app_id"}})],1),a("FormItem",[a("Input",{attrs:{placeholder:"请输入应用名称"},model:{value:e.form.app_name,callback:function(t){e.$set(e.form,"app_name",t)},expression:"form.app_name"}})],1),a("FormItem",{staticStyle:{"margin-right":"0px"}},[a("Button",{staticClass:"mlm",attrs:{type:"primary"},on:{click:function(t){return e.changePage(1)}}},[e._v("搜索")]),a("Button",{staticClass:"mlm",on:{click:e.reset}},[e._v("重置")])],1)],1)],1),a("Table",{attrs:{border:"",columns:e.columns,data:e.apps,loading:e.fetchApps.isPending},scopedSlots:e._u([{key:"app_id",fn:function(t){var s=t.row;return[a("span",[e._v(e._s(s.app_id||"-"))])]}},{key:"app_name",fn:function(t){var s=t.row;return[a("span",[e._v(e._s(s.app_name||"-"))])]}},{key:"app_desc",fn:function(t){var s=t.row;return[a("span",[e._v(e._s(s.desc||"-"))])]}},{key:"app_secret",fn:function(t){var s=t.row,r=t.index;return[a("Row",{attrs:{type:"flex",justify:"space-between"}},[e.secretIndex!==r?[a("h3",[e._v("******")]),a("Icon",{attrs:{type:"ios-eye",size:"20"},on:{click:function(t){e.secretIndex=r}}})]:[a("span",[e._v(e._s(s.app_secret||"-"))]),a("Icon",{attrs:{type:"ios-eye-off",size:"20"},on:{click:function(t){e.secretIndex=-1}}})]],2)]}},{key:"nick_name",fn:function(t){var s=t.row;return[a("span",[e._v(e._s(s.nick_name||"-"))]),a("p",{staticClass:"txt-muted"},[e._v(e._s(s.company_name||"-"))])]}},{key:"action",fn:function(t){var s=t.row;return[a("a",{on:{click:function(t){return e.shareApp(s)}}},[e._v("分享")])]}}])}),a("Row",{staticClass:"mtm",attrs:{type:"flex",justify:"end"}},[a("Page",{attrs:{current:e.page.index,total:e.page.total,"page-size":e.page.size,"show-total":"","show-elevator":""},on:{"on-change":e.changePage}})],1)],1)},r=[],o=(a("8d0d"),a("9ec3")),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{attrs:{"mask-closable":!1},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[a("h3",[e._v("添加应用")])]),a("div",{staticClass:"content"},[a("Form",{ref:"form",attrs:{model:e.form}},[a("FormItem",{attrs:{label:"应用名称",prop:"app_name",rules:e.ruleNotEmpty}},[a("Input",{attrs:{placeholder:"请填写应用名称"},model:{value:e.form.app_name,callback:function(t){e.$set(e.form,"app_name",t)},expression:"form.app_name"}})],1),a("FormItem",{attrs:{label:"应用描述",prop:"app_desc",rules:e.ruleNotEmpty}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},maxlength:"512",placeholder:"请填写应用描述"},model:{value:e.form.app_desc,callback:function(t){e.$set(e.form,"app_desc",t)},expression:"form.app_desc"}})],1),a("FormItem",{attrs:{label:"关联的公司",prop:"company_id",rules:e.ruleNotEmpty}},[a("Input",{attrs:{value:e.form.company_name,placeholder:"获取用户关联公司信息失败，请刷新再试",readonly:""}})],1)],1)],1),a("div",{staticClass:"footer",attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),a("Button",{attrs:{type:"primary",loading:e.fetchCreateApp.isPending},on:{click:e.submit}},[e._v("确定")])],1)])},l=[],i=a("22dc"),c={props:{companyinfo:Object},data(){return{visible:!0,form:{app_name:"",app_desc:"",company_id:"",company_name:""},ruleNotEmpty:{required:!0,message:"不能为空"}}},mounted(){this.form.company_id=this.companyinfo.company_id||"",this.form.company_name=this.companyinfo.company_name||""},methods:{submit(){this.$refs.form.validate(e=>{e?this.fetchCreateApp():this.$Message.error("提交失败，请检查是否有遗漏")})}},asyncMethods:{fetchCreateApp(){const{form:e}=this,t={app_name:e.app_name,app_desc:e.app_desc,company_id:e.company_id};return Object(i["b"])(t).then(()=>{this.visible=!1,this.$Message.success("添加成功！"),this.$emit("refresh")}).catch(e=>{this.$Message.error("添加失败："+e.message)})}}},m=c,p=a("2be6"),u=Object(p["a"])(m,n,l,!1,null,null,null),d=u.exports,h=a("261f"),f={components:{editApp:d,share:h["a"]},data(){return{form:{app_id:"",app_name:""},columnsOption:{app_id:"应用ID",app_name:"应用名称",app_desc:"应用描述",app_secret:"密钥",nick_name:"创建人/关联的公司",action:"操作"},apps:[],page:{index:1,size:10,total:0},secretIndex:-1}},computed:{companyinfo(){return this.$store.state.companyinfo},columns(){return Object(o["map"])(this.columnsOption,(e,t)=>{const a={title:e,slot:t};return t.includes("secret")&&this.$set(a,"minWidth",100),a})}},mounted(){this.fetchApps()},methods:{reset(){Object(o["forIn"])(this.form,(e,t)=>{this.form[t]=""}),this.changePage(1)},changePage(e){this.page.index=e,this.fetchApps()},createApp(){const{companyinfo:e}=this;this.$FastModal.show(d,{companyinfo:e},{refresh(){this.fetchApps()}})},shareApp(e){this.$FastModal.show(h["a"],{objectId:e.app_id,objectType:"application",userTypeFilter:["user"],companyinfo:this.companyinfo},{})}},asyncMethods:{fetchApps(){const{form:e,page:t}=this,a={page:{start:(t.index-1)*t.size,size:t.size,return_total:1}};return Object(o["forIn"])(e,(e,t)=>{e&&(a[t]=e)}),Object(i["q"])(a).then(e=>(t.total=e.total,e.data))}}},_=f,b=(a("efb27"),Object(p["a"])(_,s,r,!1,null,"dc61a116",null));t["default"]=b.exports},ce46:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Row",{attrs:{type:"flex",justify:"space-between"}},[a("Button",{attrs:{type:"success",icon:"md-add"},on:{click:e.createPerm}},[e._v("添加新的权限")]),a("Form",{ref:"form",attrs:{inline:"","label-width":0}},[a("FormItem",[a("Input",{attrs:{placeholder:"请输入domain关键词"},model:{value:e.form.domain,callback:function(t){e.$set(e.form,"domain",t)},expression:"form.domain"}})],1),a("FormItem",[a("Input",{attrs:{placeholder:"请输入action关键词"},model:{value:e.form.action,callback:function(t){e.$set(e.form,"action",t)},expression:"form.action"}})],1),a("FormItem",{staticStyle:{"margin-right":"0px"}},[a("Button",{staticClass:"mlm",attrs:{type:"primary"},on:{click:e.fetchPerms}},[e._v("搜索")]),a("Button",{staticClass:"mlm",on:{click:e.reset}},[e._v("重置")])],1)],1)],1),a("Table",{attrs:{border:"",columns:e.columns,data:e.perms,"span-method":e.mergeRow,loading:e.fetchPerms.isPending},scopedSlots:e._u([{key:"domain",fn:function(t){var s=t.row;return[a("h3",[e._v(e._s(s.domain||"-"))])]}},{key:"action",fn:function(t){var s=t.row;return[a("span",[e._v(e._s(s.action||"-"))])]}},{key:"perm_params_schema",fn:function(t){var s=t.row;return[a("span",[e._v(e._s(s.perm_params_schema||"-"))])]}},{key:"perm_name",fn:function(t){var s=t.row;return[a("span",[e._v(e._s(s.perm_name||"-"))])]}},{key:"actions",fn:function(t){var s=t.row;return[a("a",{on:{click:function(t){return e.editPerm(s)}}},[e._v("编辑")]),a("Divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.deletePerm(s)}}},[e._v("删除")])]}}])}),a("PermDelete",{ref:"PermDelete"})],1)},r=[],o=(a("8d0d"),a("9ec3")),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{attrs:{width:"600","mask-closable":!1},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[a("h3",[e._v(e._s(e.perm?"编辑权限":"新增权限"))])]),a("div",{staticClass:"content"},[a("Form",{ref:"form",attrs:{model:e.form}},[a("FormItem",{attrs:{label:"权限名称",prop:"perm_name",rules:{required:!0,message:"不能为空"}}},[a("Input",{attrs:{placeholder:"请填写权限名称"},model:{value:e.form.perm_name,callback:function(t){e.$set(e.form,"perm_name",t)},expression:"form.perm_name"}})],1),a("FormItem",{attrs:{label:"domain",prop:"domain",rules:{required:!0,message:"不能为空"}}},[a("Input",{attrs:{placeholder:"请填写domain值"},model:{value:e.form.domain,callback:function(t){e.$set(e.form,"domain",t)},expression:"form.domain"}})],1),a("FormItem",{attrs:{label:"action",prop:"action",rules:{required:!0,message:"不能为空"}}},[a("Input",{attrs:{placeholder:"请填写action值"},model:{value:e.form.action,callback:function(t){e.$set(e.form,"action",t)},expression:"form.action"}})],1),a("FormItem",[a("div",{attrs:{slot:"label"},slot:"label"},[a("span",[e._v("extra")]),a("span",{staticClass:"txt-muted"},[e._v(" ( extra值需要有{}包裹，例如{params1:{}, params2:{}} )")])]),a("Input",{attrs:{placeholder:"请填写extra值，非必填"},model:{value:e.form.perm_params_schema,callback:function(t){e.$set(e.form,"perm_params_schema",t)},expression:"form.perm_params_schema"}})],1)],1)],1),a("div",{staticClass:"footer",attrs:{slot:"footer"},slot:"footer"},[a("Button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),a("Button",{attrs:{type:"primary",loading:e.fetchUpdatePerm.isPending},on:{click:e.submit}},[e._v("确定")])],1)])},l=[],i=a("22dc"),c={props:{perm:Object},data(){return{visible:!0,form:{domain:"",action:"",perm_params_schema:"",perm_name:""}}},computed:{submitParams(){const{perm:e}=this,{domain:t,action:a,perm_params_schema:s,perm_name:r}=this.form,o={domain:t,action:a,perm_params_schema:s||"{}",perm_name:r};return e&&(o.perm_id=e.perm_id),o}},mounted(){this.perm&&(this.form={...this.perm})},methods:{submit(){this.$refs.form.validate(e=>{if(e){const e=this.perm?this.fetchUpdatePerm():this.fetchCreatePerm();e.then(e=>{e?(this.$Message.success("提交成功"),this.visible=!1,this.$emit("refresh")):this.$Message.error("提交失败："+e.message)}).catch(e=>{console.log(e),this.$Message.error("提交失败："+e.message)})}else this.$Message.error("提交失败，请检查是否有遗漏")})}},asyncMethods:{fetchCreatePerm(){return Object(i["c"])(this.submitParams)},fetchUpdatePerm(){return Object(i["s"])(this.submitParams)}}},m=c,p=a("2be6"),u=Object(p["a"])(m,n,l,!1,null,null,null),d=u.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div")},f=[],_={data(){return{perm:{}}},methods:{DeletePerm(e){const t=new Promise(t=>{this.perm=e,this.$Modal.confirm({title:"删除权限",content:`<p>确定将权限行为 ${this.perm.action} (${this.perm.perm_name}) 删除吗？</p>`,loading:!0,onOk:()=>{this.fetchDeletePerm().then(()=>{t(),this.$Modal.remove()})}})});return t}},asyncMethods:{fetchDeletePerm(){const e={perm_id:this.perm.perm_id};return Object(i["g"])(e).then(e=>{e?this.$Message.success("删除成功！"):this.$Message.error("删除失败")}).catch(e=>{this.$Message.error("删除失败："+e.message)})}}},b=_,v=Object(p["a"])(b,h,f,!1,null,null,null),g=v.exports,y={components:{PermEdit:d,PermDelete:g},data(){return{form:{domain:"",action:""},columnsOption:{domain:"domain",action:"action",perm_params_schema:"extra",perm_name:"权限名称",actions:"操作"},perms:[],permsGroup:[]}},computed:{columns(){return Object(o["map"])(this.columnsOption,(e,t)=>{const a={title:e,slot:t};return t.includes("domain")&&(a.fixed="left"),a})}},mounted(){this.fetchPerms()},methods:{reset(){Object(o["forIn"])(this.form,(e,t)=>{this.form[t]=""}),this.fetchPerms()},mergeRow({row:e,columnIndex:t}){const a=this.permsGroup[e.domain],s=!(0!==t),r=!!((null===a||void 0===a?void 0:a.length)>0),o=!!((null===a||void 0===a?void 0:a.length)>1);if(s&&r)return o?e.action===a[0].action?[a.length,1]:[0,0]:[1,1]},createPerm(){const e=this;this.$FastModal.show(d,{},{refresh(){e.reset()}})},editPerm(e){const t=this;this.$FastModal.show(d,{perm:e},{refresh(){t.reset()}})},deletePerm(e){this.$refs.PermDelete.DeletePerm(e).then(()=>{this.fetchPerms()})}},asyncMethods:{fetchPerms(){const{form:e}=this,t={domain:e.domain||void 0,action:e.action||void 0};return Object(i["m"])(t).then(e=>{const t=Object(o["orderBy"])(e,"domain");return this.permsGroup=Object(o["groupBy"])(t,"domain"),t})}}},k=y,$=(a("fce2"),Object(p["a"])(k,s,r,!1,null,"210c05b8",null));t["default"]=$.exports},d2db:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Row",{attrs:{type:"flex",justify:"space-between",align:"middle"}},[a("Breadcrumb",[a("BreadcrumbItem",[e._v("平台管理")]),a("BreadcrumbItem",{attrs:{to:"/admin/template/index"}},[e._v("通用模板列表")]),a("BreadcrumbItem",[e._v(e._s(e.template_id?"编辑模板":"创建模板"))])],1)],1),a("t-divider",{attrs:{align:"left"}},[a("h3",[e._v(e._s(e.template_id?"编辑模板":"创建模板"))])]),a("br"),a("div",{staticStyle:{margin:"0 30px"}},[a("div",{staticClass:"title",staticStyle:{padding:"0 0 20px"}},[e._v("基本信息")]),a("Form",{ref:"createForm",staticClass:"form-width",attrs:{model:e.form,"label-position":"top"}},[a("FormItem",{attrs:{label:"标注场景",prop:"templateScene",rules:{required:!0,message:"标注场景不能为空"}}},[a("RadioGroup",{model:{value:e.form.templateScene,callback:function(t){e.$set(e.form,"templateScene",t)},expression:"form.templateScene"}},e._l(e.TemplateScenes,(function(e){return a("Radio",{key:e,staticClass:"mrl",attrs:{value:e,label:e}})})),1)],1),a("Row",{staticStyle:{position:"relative"},attrs:{type:"flex",align:"bottom"}},[e.fetchTemplateLevel1s.isPending?a("Spin",{attrs:{fix:""}}):e._e(),a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"mrl",attrs:{label:"模板类型",prop:"templateLevel1",rules:{required:!0,message:"模板一级分类不能为空"}}},[a("Select",{ref:"select",attrs:{placeholder:"请选择或输入一级分类",clearable:"",filterable:"","allow-create":""},on:{"on-create":e.handleCreateLevel1},model:{value:e.form.templateLevel1,callback:function(t){e.$set(e.form,"templateLevel1",t)},expression:"form.templateLevel1"}},e._l(e.templateLevel1s,(function(t){return a("Option",{key:t.template_level1,attrs:{value:t.template_level1}},[e._v(e._s(t.template_level1))])})),1)],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{staticClass:"mrm",attrs:{"label-width":0,prop:"templateLevel2",error:e.level2error}},[a("Input",{attrs:{placeholder:"请输入二级分类"},model:{value:e.form.templateLevel2,callback:function(t){e.$set(e.form,"templateLevel2",t)},expression:"form.templateLevel2"}})],1)],1)],1),a("FormItem",{attrs:{label:"标注工具",prop:"stage",rules:{required:!0,message:"标注工具不能为空"}}},[a("Select",{model:{value:e.form.stage,callback:function(t){e.$set(e.form,"stage",t)},expression:"form.stage"}},e._l(e.stageMetadata,(function(t){return a("Option",{key:t.name,attrs:{value:t.name}},[e._v(e._s(t.label))])})),1)],1),a("FormItem",{attrs:{label:"模板名称",prop:"templateName",rules:{required:!0,message:"模板名称不能为空"}}},[a("Input",{attrs:{placeholder:"请输入模板名称"},model:{value:e.form.templateName,callback:function(t){e.$set(e.form,"templateName",t)},expression:"form.templateName"}})],1),a("FormItem",{attrs:{label:"模板描述",prop:"templateDesc",rules:{required:!0,message:"模板描述不能为空"}}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"请输入描述"},model:{value:e.form.templateDesc,callback:function(t){e.$set(e.form,"templateDesc",t)},expression:"form.templateDesc"}})],1)],1),a("div",{staticClass:"action-btn"},[a("Button",{attrs:{loading:e.fetchCreateTemplate.isPending||e.fetchTemplateLevel2s.isPending,type:"success"},on:{click:e.submit}},[e._v("提交")]),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1)},r=[],o=a("9ec3"),n=a.n(o),l=a("22dc"),i=a("b0f9"),c=a("2289"),m={data(){return{TemplateScenes:c["i"],form:{templateName:"",templateDesc:"",templateScene:"图片标注",templateLevel1:"",templateLevel2:"",isPublic:1,templateSchema:"[]",origin:"自建",component:"",scene:[],templateSample:"{}",stage:""},msg:"新增模板成功！请继续完善模板",template_id:this.$route.query.id,isCopy:this.$route.query.isCopy,data:[],templateLevel1s:[],timer:"",level2error:"",stageMetadata:this.$OptimusStageMetadata}},watch:{"form.templateScene"(){this.fetchTemplateLevel1s(),this.$refs.select.clearSingleSelect(),this.form.templateLevel1="",this.form.templateLevel2=""}},created(){(this.template_id||this.isCopy)&&(this.msg="修改模板成功",this.isCopy&&(this.msg="复制模板成功"),this.getEditTemplate())},mounted(){this.fetchTemplateLevel1s()},methods:{submit(){this.$refs.createForm.validate(e=>{e?this.fetchTemplateLevel2s().then(e=>{e&&e.length>0?this.$Message.error("模板类型已存在，请更改分类"):this.fetchCreateTemplate()}):this.$Message.error("提交失败，请检查是否有遗漏")})},reset(){this.$refs.createForm.resetFields()},handleCreateLevel1(e){this.templateLevel1s.push({template_level1:e})}},asyncMethods:{fetchCreateTemplate(){const e=n.a.chain(this.stageMetadata).find({name:this.form.stage}).value(),t={component:this.form.stage,attributes:{},items:[],$object_items:[],$object_tools:e.defaultTools?e.defaultTools:[]},a={template_name:this.form.templateName,template_desc:this.form.templateDesc,template_scene:this.form.templateScene,template_level1:this.form.templateLevel1,template_level2:this.form.templateLevel2,template_schema:this.form.templateSchema.replace(/\r|\n|\s+/g,""),template_origin:0,template_component:JSON.stringify(t),template_sample:this.form.templateSample};return l["f"](a).then(()=>{this.$Message.success("创建模板成功！"),this.$router.push({path:"/admin/template/index"})}).catch(e=>{this.$Message.error("创建模板失败："+e.message)})},fetchTemplateLevel1s(){const e={template_scene:this.form.templateScene};return Object(i["e"])(e).then(e=>n.a.uniqBy(e,"template_level1"))},fetchTemplateLevel2s(){const e={template_scene:this.form.templateScene,template_level1:this.form.templateLevel1,template_level2:this.form.templateLevel2};return Object(i["e"])(e).then(e=>e)}}},p=m,u=(a("0b78"),a("2be6")),d=Object(u["a"])(p,s,r,!1,null,"1978b194",null);t["default"]=d.exports},d9a8:function(e,t,a){"use strict";a("611e")},e28c:function(e,t,a){},e651:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Layout",[a("Sider",{style:{background:"#fff"},attrs:{"hide-trigger":""}},[a("Menu",{attrs:{"active-name":e.activeName,theme:"light",width:"auto","open-names":["1","2","3","4"]}},[a("MenuGroup",{attrs:{title:"后台管理"}}),a("Submenu",{attrs:{name:"2"}},[a("template",{slot:"title"},[a("span",[e._v("平台管理")])]),a("MenuItem",{attrs:{name:"/company",to:"/admin/company"}},[e._v("公司列表")]),a("MenuItem",{attrs:{name:"/manager",to:"/admin/manager"}},[e._v("管理员列表")]),a("MenuItem",{attrs:{name:"/role",to:"/admin/role"}},[e._v("角色列表")]),a("MenuItem",{attrs:{name:"/auth",to:"/admin/auth"}},[e._v("权限列表")]),a("MenuItem",{attrs:{name:"/template",to:"/admin/template/index"}},[e._v("通用模板列表")]),a("MenuItem",{attrs:{name:"/app",to:"/admin/app"}},[e._v("应用管理")])],2)],1)],1),a("Layout",{staticClass:"layout-container"},[a("Alert",{staticClass:"mtm",attrs:{type:"success","show-icon":"",closable:""}},[e._v("您正处于后台管理模块。")]),a("Content",{staticClass:"layout-container-content"},[a("router-view")],1),a("Copyright")],1)],1)},r=[],o=a("2a20"),n={components:{Copyright:o["default"]},computed:{activeName(){return this.$route.path.match(/(\/[\w-]+)/g)[1]}}},l=n,i=a("2be6"),c=Object(i["a"])(l,s,r,!1,null,null,null);t["default"]=c.exports},ea81:function(e,t,a){"use strict";a("510c")},efb27:function(e,t,a){"use strict";a("fb2a")},f227:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Select",{attrs:{filterable:"",clearable:"",transfer:"",placeholder:e.placeholder,multiple:e.multiple,loading:e.fetchUserOptions.isPending,"remote-method":e.debounce},on:{"on-change":e.updateUser,"on-clear":function(t){return e.updateUser("")}},model:{value:e.users,callback:function(t){e.users=t},expression:"users"}},[this.userInfo?a("OptionGroup",{attrs:{label:"当前登录人"}},[a("Option",{key:this.userInfo.user.user_id,attrs:{value:e.userInfo.user[e.optionValue],label:e.multiple?e.userInfo.user.nick_name+e.userInfo.user.email:e.userInfo.user.nick_name,tag:e.userInfo.user.nick_name}},[a("p",[e._v(e._s(e.userInfo.user.nick_name))]),e.showEmail?a("p",{staticClass:"txt-muted"},[e._v(e._s(e.userInfo.user.email||"无邮箱"))]):e._e()])],1):e._e(),a("OptionGroup",{attrs:{label:"搜索"}},e._l(e.userOptions,(function(t){return a("Option",{key:t.user_id,attrs:{value:t[e.optionValue],label:e.multiple?t.nick_name+t.email:t.nick_name,tag:t.nick_name}},[a("p",[e._v(e._s(t.nick_name))]),e.showEmail?a("p",{staticClass:"txt-muted"},[e._v(e._s(t.email||"无邮箱"))]):e._e()])})),1)],1)],1)},r=[],o=a("9ec3"),n=a("e3fa"),l={props:{optionValue:{type:String,default:"user_id"},multiple:{type:[Boolean,String],default:!1},remote:{type:[Boolean,String],default:!1},showEmail:{type:[Boolean,String],default:!1},defaultUser:{type:Boolean,default:!1},placeholder:{type:String,default:"请输入关键字以搜索相关用户"}},data(){return{users:""}},computed:{queryParams(){return function(e){const t={page:{start:0,size:100,return_total:0},query:e};return t}},userInfo(){var e,t;return null===this||void 0===this||null===(e=this.$store)||void 0===e||null===(t=e.state)||void 0===t?void 0:t.userinfo}},mounted(){!this.remote&&this.fetchUserOptions()},methods:{debounce:Object(o["debounce"])((function(e){this.fetchUserOptions(e)}),500),updateUser(e){e!==this.user&&(this.users=e||"",this.$emit("update:user",this.users))}},asyncMethods:{fetchUserOptions(e){if(""!==e)return Object(n["t"])(this.queryParams(e)).then(e=>null===e||void 0===e?void 0:e.data.filter(e=>{var t,a;return e.user_id!==(null===(t=this.userInfo)||void 0===t||null===(a=t.user)||void 0===a?void 0:a.user_id)}))}}},i=l,c=a("2be6"),m=Object(c["a"])(i,s,r,!1,null,null,null);t["a"]=m.exports},f607:function(e,t,a){"use strict";a("e28c")},fb2a:function(e,t,a){},fb60:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return r}));var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",[e._v("Copyright©1998-"+e._s((new Date).getFullYear())+" Tencent Inc. All Rights Reserved.")])},r=[]},fce2:function(e,t,a){"use strict";a("5897")}}]);