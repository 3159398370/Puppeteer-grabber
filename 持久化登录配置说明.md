# 持久化登录配置说明

## 概述

为了解决每次启动Selenium自动化时都需要重新登录的问题，项目已配置持久化登录功能。通过使用固定的Chrome用户数据目录，系统能够保存登录状态，避免重复的二维码扫描过程。

## 配置详情

### 1. 企鹅标注平台持久化登录

**文件位置：** `scripts/task_search.py`

**用户数据目录：** `chrome_user_data/`

**配置说明：**
- 使用固定的用户数据目录存储登录信息
- 首次使用需要扫描二维码登录
- 后续启动将自动保持登录状态

### 2. 腾讯元宝持久化登录

**文件位置：** `src/automation/yuanbao_client.py`

**用户数据目录：** `chrome_user_data_yuanbao/`

**配置说明：**
- 独立的用户数据目录，避免与企鹅标注平台冲突
- 保持腾讯元宝的登录状态和会话信息
- 提高自动化处理效率

## 使用方法

### 首次使用

1. **启动脚本**
   ```bash
   python scripts/task_search.py
   ```

2. **完成登录**
   - 系统会提示需要扫描二维码
   - 使用手机扫描页面上的二维码完成登录
   - 登录信息将自动保存到用户数据目录

3. **正常使用**
   - 完成首次登录后，系统会自动进入任务页面
   - 腾讯元宝自动化也会保持登录状态

### 后续使用

1. **自动登录**
   - 再次启动脚本时，系统会自动检查登录状态
   - 如果登录信息有效，将直接进入任务页面
   - 无需重复扫描二维码

2. **会话过期处理**
   - 如果登录会话过期，系统会自动检测
   - 提示重新扫描二维码
   - 完成登录后继续保持持久化状态

## 目录结构

```
Puppeteer-grabber/
├── chrome_user_data/          # 企鹅标注平台用户数据
│   ├── Default/
│   └── ...
├── chrome_user_data_yuanbao/  # 腾讯元宝用户数据
│   ├── Default/
│   └── ...
└── ...
```

## 注意事项

### 1. 数据安全
- 用户数据目录包含个人登录信息
- 已添加到 `.gitignore` 文件，不会提交到版本控制
- 请妥善保管本地用户数据目录

### 2. 目录管理
- 如需重置登录状态，可删除对应的用户数据目录
- 系统会在下次启动时自动重新创建目录
- 删除目录后需要重新登录

### 3. 多用户使用
- 每个用户应使用独立的项目副本
- 避免共享用户数据目录
- 确保登录信息的隔离性

### 4. 故障排除

**问题：仍然需要重复登录**
- 检查用户数据目录是否存在
- 确认目录权限是否正确
- 尝试删除用户数据目录重新登录

**问题：浏览器启动失败**
- 检查 `chromedriver.exe` 是否存在
- 确认Chrome浏览器版本兼容性
- 查看错误日志获取详细信息

## 优势

1. **提高效率**
   - 避免每次启动都需要扫描二维码
   - 减少人工干预，提高自动化程度

2. **保持会话**
   - 维持登录状态和用户偏好设置
   - 保存浏览器历史和缓存信息

3. **稳定性增强**
   - 减少因重复登录导致的会话冲突
   - 提供更稳定的自动化环境

4. **用户体验**
   - 简化操作流程
   - 提供更流畅的使用体验

## 更新日志

- **2024-08-13**: 实现企鹅标注平台和腾讯元宝的持久化登录配置
- **2024-08-13**: 添加用户数据目录到 `.gitignore` 文件
- **2024-08-13**: 创建持久化登录配置说明文档